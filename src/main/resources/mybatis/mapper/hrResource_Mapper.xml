<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.employee.hrResource.mapper.IHrMapper">

	<resultMap type="kr.or.ddit.vo.EmpVO" id="empMap">
		<id property="empNo" column="emp_no"/>
		<result property="empNo" column="emp_no"/>
		<result property="password" column="PASSWORD"/>
		<result property="jbgdCd" column="JBGD_CD"/>
		<result property="empNm" column="EMP_NM"/>
		<result property="brdt" column="BRDT"/>
		<result property="email" column="EMAIL"/>
		<result property="wnmpyEmail" column="WNMPY_EMAIL"/>
		<result property="telno" column="TELNO"/>
		<result property="extNo" column="EXT_NO"/>
		<result property="empZip" column="EMP_ZIP"/>
		<result property="homeAddr" column="HOME_ADDR"/>
		<result property="homeDaddr" column="HOME_DADDR"/>
		<result property="jncmpYmd" column="JNCMP_YMD"/>
		<result property="rsgntnYmd" column="RSGNTN_YMD"/>
		<result property="bankCd" column="BANK_CD"/>
		<result property="actno" column="ACTNO"/>
		<result property="dpstrNm" column="DPSTR_NM"/>
		<result property="salary" column="SALARY"/>
		<result property="profileFilePath" column="PROFILE_FILE_PATH"/>
		<result property="signFilePath" column="SIGN_FILE_PATH"/>
		<result property="userFolderUsgqty" column="USER_FOLDER_USGQTY"/>
		<result property="photoKey" column="PHOTO_KEY"/>
		<result property="enabled" column="ENABLED"/>
		<result property="upperDeptNo" column="upper_dept_no"/>
		<result property="workTyNo" column="work_ty_no"/>
		<result property="deptNm" column="dept_nm"/>
		<result property="deptNo" column="dept_no"/>
		<collection property="authList" resultMap="authMap" />
		<collection property="deptList" resultMap="deptmap"></collection>
	</resultMap>
	
	<resultMap type="kr.or.ddit.vo.EmpAuthVO" id="authMap">
		<result property="empNo" column="emp_no"/>
		<result property="authNm" column="auth_nm"/>
	</resultMap>
	
	<resultMap type="kr.or.ddit.vo.DeptVO" id="deptmap">
		<result property="deptNo" column="DEPT_NO"/>
		<result property="upperDeptNo" column="UPPER_DEPT_NO"/>
		<result property="workTyNo" column="WORK_TY_NO"/>
		<result property="deptNm" column="DEPT_NM"/>
		<result property="deptCrtYmd" column="DEPT_CRT_YMD"/>
	</resultMap>

	<select id="checkPassword" parameterType="string" resultType="string">
		select password 
		from
			emp
		where emp_no = #{empNo}
	</select>

	<update id="changePW" parameterType="kr.or.ddit.vo.EmpVO">
		update emp
		set
			password = #{password}
		where
			emp_no = #{empNo}
	</update>

	<update id="changeInfo" parameterType="kr.or.ddit.vo.EmpVO">
	
		update emp
		set
			WNMPY_EMAIL = #{wnmpyEmail}
			,TELNO = #{telno}
			,EXT_NO = #{extNo}
		where emp_no = #{empNo} 
	</update>
	
	<select id="getMyInfo" parameterType="kr.or.ddit.vo.EmpVO" resultMap="empMap">
		SELECT ep.*,at.auth_nm,upper_dept_no,work_ty_no,dept_nm
		FROM emp ep
		LEFT OUTER JOIN auth AT
		    ON EP.EMP_NO = AT.EMP_NO
        LEFT OUTER JOIN dept dt
            ON EP.DEPT_NO = DT.DEPT_NO
		WHERE ep.emp_no = #{empNo}
	</select>

</mapper>